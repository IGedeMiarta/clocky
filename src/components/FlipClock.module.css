/* src/components/FlipClock.module.css */

.container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    width: 100vw;
    background-color: #111;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    overflow: hidden;
    user-select: none;
    position: relative;
    /* Needed for absolute positioning of button */
}

/* Full Screen Button */
.fullScreenBtn {
    position: absolute;
    bottom: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    border: none;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    color: #ccc;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 100;
    backdrop-filter: blur(5px);
}

.fullScreenBtn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
    color: #fff;
}

.fullScreenBtn svg {
    width: 20px;
    height: 20px;
}



/* Responsiveness for vertical screens */
@media (orientation: portrait) {
    .clock {
        flex-direction: column;
        gap: 2vh;
        /* Minimal gap */
        align-items: center;
    }
}




/* AM/PM Label inside card */
.cardLabel {
    position: absolute !important;
    top: 40px !important;
    left: 40px !important;

    font-size: 4vw;
    /* Relative to width */
    font-weight: bold;
    color: #ccc;
    z-index: 20;
    line-height: normal !important;
    text-transform: uppercase;
    width: auto !important;
    height: auto !important;
    display: block !important;
    background: transparent !important;
    transform: none !important;
    /* Ensure it doesn't get transformed by generic rules */
}




@media (max-width: 600px) {
    .cardLabel {
        font-size: 20px;
        top: 15px !important;
        left: 15px !important;
    }
}


/* Adjust layout to include AM/PM seamlessly */
.clock {
    display: flex;
    align-items: center;
    gap: 2vw;
    /* Reduced gap */
    transform-style: preserve-3d;
    perspective: 1000px;
}

.group {
    display: flex;
    gap: 5px;
    /* Gap between digits in a group if separated */
}


/* Flip Card Container */


/* Flip Card Container - Maximized Viewport Sizing */
.card {
    position: relative;
    /* Landscape: Side-by-side, max width */
    width: 45vw;
    height: 85vh;
    background-color: #333;
    border-radius: 3vw;
    overflow: hidden;

    /* Font styling - Scaled to viewport */
    font-size: 40vw;
    /* Scales with width */
    font-weight: bold;
    font-variant-numeric: tabular-nums;
    color: #ccc;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

/* Font size adjustment to fit height if screen is ultra-wide */
@media (min-aspect-ratio: 16/9) {
    .card {
        font-size: 80vh;
        /* Scales with height if wide */
    }
}

/* Portrait Mode: Stacked */
@media (orientation: portrait) {
    .card {
        width: 90vw;
        height: 42vh;
        /* 2 cards + gap < 100vh */
        font-size: 35vh;
        /* Fit within the height */
        border-radius: 3vh;
    }
}

/* Common styles for half-cards */
.upper,
.lower,
.flipFront,
.flipBack {
    position: absolute;
    left: 0;
    width: 100%;
    height: 50%;
    overflow: hidden;
    background-color: #222;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* Upper Half specific */
.upper,
.flipFront {
    top: 0;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.5);
    transform-origin: 50% 100%;
    z-index: 1;
}

/* Lower Half specific */
.lower,
.flipBack {
    bottom: 0;
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
    border-top: 1px solid rgba(0, 0, 0, 0.5);
    transform-origin: 50% 0%;
    z-index: 2;
}

/* Text Positioning Logic */
/* The span acts as the full card content */
.upper span,
.flipFront span,
.lower span,
.flipBack span {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 200%;
    /* Double height relative to half-card parent = Full Card Height */
    line-height: 1;
    /* Reset line-height */
}

/* Upper spans align to top 0 */
.upper span,
.flipFront span {
    position: absolute;
    top: 0;
    left: 0;
}

/* Lower spans align to top -100% (shifting up to show bottom half) */
.lower span,
.flipBack span {
    position: absolute;
    top: -100%;
    left: 0;
}

/* Flap Layers */
.flap {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 50%;
    z-index: 10;
    transform-style: preserve-3d;
    transform-origin: bottom;
}

/* Ensure faces inside the flap fill the flap height (which is 50% of card) */
.flap .upper,
.flap .lower {
    height: 100%;
}

.flap.flipping {
    animation: flipDown 0.6s ease-in-out forwards;
}

.flipFront {
    z-index: 2;
    transform: rotateY(0deg);
}


.flipBack {
    z-index: 1;
    position: absolute;
    top: 0;
    left: 0;
    bottom: auto;
    /* Override .lower */
    width: 100%;
    height: 100%;
    transform: rotateX(180deg);
    transform-origin: 50% 50%;
    /* Override .lower's top-edge origin */
    backface-visibility: hidden;
    background-color: #333;
    border-radius: 0 0 12px 12px;
    /* Ensure bottom corners are rounded */
}

.flipBack span {
    /* 
       Since flipBack is a "bottom half" container physically,
       but the span is 200% height.
       We need to ensure it shows the bottom half of the text.
       BUT, due to rotateX(180deg), coordinate system might be flipped?
       No, rotateX affects rendering plane.
       The span positioning `top: -100%` puts the top half of text above the container.
       So the container shows the bottom half.
       This seems correct.

       Wait, if we see the NUMBER upside down or cut off from the wrong side.
       Let's check the screenshot. 
       The screenshot shows:
       - Top Box: 20 (Correct)
       - Bottom Box: 29 (Partially flipped? Or showing Top Half of 29 in the bottom box?)
       
       It looks like the bottom flipping card is showing the WRONG part of the number or wrong alignment.
       In the screenshot, the "29" looks like it's cut through the middle, but maybe the top half is showing in the bottom slot?
       
       If `top: -100%` is applied to `.flipBack span`, and `.flipBack` effectively acts as a bottom-half window:
       - Span Top: -100% (The top half of text is above the viewing area).
       - Viewing Area: 0 to 100% (The bottom half of text).
       
       This logic holds for a normal bottom half.
       
       BUT, `.flipBack` is inside `.flap`.
       `.flap` is positioned at `top: 0` (Top Half position).
       
       Wait! 
       `.flap` matches `.upper` geometry (Top Half).
       So `.flipBack` (inside `.flap`) has the geometry of a TOP HALF.
       
       If `.flipBack` acts as a bottom half content-wise, but lives in a top-half box:
       - We need to shift the content so that the BOTTOM half of the number is visible.
       
       If `.flipBack span` has `top: -100%`:
       - It shifts the text UP by 200px (assuming 200px half height).
       - Content visible in the window (0-200px): The bottom half of the number.
       
       This seems correct IF `.flipBack` renders right-side up.
       
       However, if the "Cut" is wrong, maybe the line-height or masking is off.
       
       Actually, look at the screenshot again (Step 141).
       The bottom card shows "29". The '9' looks like the top loops are cut off?
       Or is it showing the top part of '29' in the bottom box?
       
       If the bottom box shows the top half of the number, then `top: 0` was applied instead of `top: -100%`.
       Check the CSS.
       `.lower span, .flipBack span { top: -100%; }`
       This logic is in place.
       
       Maybe `rotateX(180)` is flipping the content rendering?
       If I take a "Bottom Half" (Text shifted up), and FLIP it upside down (RotateX 180).
       Top becomes Bottom.
       The "Visible Bottom Half" becomes "Visible Top Half" physically?
       
       Let's trace:
       1. Content: [TOP | BOTTOM]
       2. Mask: Shows [BOTTOM]. (Window starts at middle, goes down).
       3. RotateX(180): Flips vertical.
          Now [BOTTOM] is upside down?
          
       We want `.flipBack` to look like a normal `.lower` card when the flip finishes (at -180deg).
       
       Flap (-180deg) * Back Face (180deg) = 0deg (Net rotation).
       So it renders "normally".
       
       If it renders normally, it has geometry of `.flap` (height 50%, top 0).
       Wait. `.flap` is at `top: 0`.
       So when the animation finishes, the flap is effectively covering the top part of the card?
       NO.
       RotateX(-180) moves the flap from sticking UP (covering top) to hanging DOWN (covering bottom).
       Pivot is `bottom`.
       
       - Start (0deg): Flap covers Top.
       - End (-180deg): Flap covers Bottom.
       
       So at end, `.flipBack` is covering the Bottom Static Card.
       And `.flipBack` needs to look exactly like the Bottom Static Card.
       
       Bottom Static Card `.lower`:
       - Position: `bottom: 0`.
       - Content: `top: -100%` (Bottom half text).
       
       Flap `.flipBack`:
       - Parent `.flap`: Position `top: 0`. (This is the physical anchor).
       - When rotated -180deg around bottom:
         The generic "box" hanging down matches the `bottom: 0` area.
         
       Issues potentially:
       1. `backface-visibility`.
       2. Alignment shift due to border/padding.
       3. `.flap` is `height 50%`.
       
       Wait, if `.flap` is at `top: 0`, and we rotate -180 around BOTTOM.
       The "Front" face (Top Half) swings down.
       The "Back" face (Bottom Half) swings into view.
       
       Since `.flipBack` is `height: 100%` of `.flap` (so 50% of card).
       And `.flap` is the top half container.
       
       The content inside `.flipBack` needs to be aligned to show the bottom half of the number.
       Currently `top: -100%`.
       
       If the issue is valid, maybe the issue is simply that `line-height` or centering is slightly off in the new font/size?
       
       Re-checking the screenshot "bug when fliped".
       The number "29" appears to have a slight misalignment or gap?
       Actually, the "29" bottom card seems to have the number shifted UP slightly? Or down?
       
       Let's try a specific fix for `flipBack` span alignment.
       Sometimes a slight pixel adjustment `translateY` is needed to match the static lower card perfectly.
       
       However, looking at the code:
       `.upper span` etc use `display: flex; justify-content: center; align-items: center;`.
       And `height: 200%`.
       
       If `align-items: center` is used on a 200% high box:
       The text is centered in that 200% box.
       
       `.upper` (Top Half Window):
       - `top: 0`.
       - Span `top: 0`.
       - Visible: Top 50% of the 200% box. (Which is the Top Half of text). Correct.
       
       `.lower` (Bottom Half Window):
       - `top: -100%`. 
       - Wait. `.lower` span is `top: -100%`.
       - This shifts the 200% box UP by 100% (its own height).
       - So the generic "Top" of the span is now at `-100%` relative to the wrapper.
       - Wrapper sees from 0 to 100%.
       - The span covers -100% to +100%.
       - Visible: The span sector from 0 to 100% relative to wrapper.
       - Since span was shifted up by 50% of its height...
       - Wait. 200% height. 
       - `top: -100%` means -1 * (Wrapper Height)?
       - Wrapper is 50% of card.
       - Span is 200% of Wrapper.
       - `top: -100%` = -1 * Wrapper Height? Yes.
       - So Span starts at -1xWrapper.
       - Span goes to +1xWrapper. (Total 2x).
       - Wrapper sees 0 to 1xWrapper.
       - This is the MIDDLE slice of the span? 
       - If Span is Height H (full text).
       - Wrapper is H/2.
       - Span is H. Use px for clarity.
       - Wrapper 200px. Span 400px.
       - Centered text is at 200px center.
       
       - Top Case: `top: 0`.
         Span 0 to 400.
         Wrapper sees 0 to 200.
         (Top Half). Correct.
         
       - Bottom Case: `top: -100%` (-200px).
         Span starts at -200?
         NO. `top` percentage is relative to PARENT (Wrapper).
         Wrapper = 200px.
         `top: -100%` = -200px.
         Span Y range: -200 to +200 relative to Wrapper (0).
         Wrapper sees 0 to 200.
         This slice is 200 to 400 of the span? 
         Wait.
         Span [0 to 400].
         Placed at Y=-200.
         Occupies -200 to 200.
         Wrapper sees 0 to 200.
         Result: The BOTTOM HALF of the span (y=200 to 400) is visible?
         Wait.
         If Span is [0..400].
         At Y=-200.
         Span[0] is at -200.
         Span[200] is at 0.
         Span[400] is at 200.
         Wrapper sees [0..200].
         So we see Span[200..400].
         This is the BOTTOM HALF. Correct.
         
       So the logic holds.
       
       Why the visual bug?
       In the screenshot, the "29" bottom (flipped) looks different or broken.
       
       Maybe `backface-visibility` is failing or Z-fighting?
       
       Also, `transform: rotateX(180deg)` on `.flipBack`.
       If I rotate the container, do I rotate the content? Yes.
       If `.flipBack` is rotated 180deg.
       The content inside is also rotated 180deg.
       So the "Bottom Half text" is rendered upside down?
       
       YES!
       If `.flipBack` has `rotateX(180deg)`, the text is upside down relative to the flap surface.
       
       When the flap rotates -180deg (physically flipping down):
       - The surface is now "right side up" relative to the viewer?
       
       Let's use the Hand Rule.
       - Flap Top Edge is pivot? No, Bottom Edge is pivot.
       - Front Face (Top Half).
       - Back Face (Bottom Half).
       
       Start (0deg): Front Face Upright. Back Face (behind it) is Upside Down?
       Rotate -180deg around Bottom Axis.
       Front Face goes Down and becomes Upside Down (hidden).
       Back Face swings Up/Out and becomes... Upright?
       
       If Back Face was pre-rotated 180deg (Upside Down relative to Front).
       Then -180 rotation makes it Upright?
       Mathematically: 180 + (-180) = 0. Yes.
       
       So text orientation should be correct.
       
       The glitch in screenshot looks like a "Gap" in the middle of 29.
       The "20" above looks fine.
       It's the bottom half of "29".
       
       It's possible that `line-height: 1` combined with `flex centered` is slightly shifting based on font metrics.
       Helvetic Neue has different baselines.
       
       Recommendation:
       Change `line-height` to matches height explicitly or use flex centering adjustment?
       Also, I notice `overflow: hidden` on `.card`.
       
       Let's try to Force the line-height to be exactly the card height (400px), not `1`.
       `line-height: 1` on 260px font = 260px height.
       Box is 400px.
       Flex center puts the 260px text in middle of 400px box.
       So 70px gap on top/bottom.
       
       Top Half (Wrapper 200px):
       Sees 0-200 of the 400px universe.
       Text is at 70 to 330.
       Top Window sees 0-200.
       Content: 70-200 is Text. 0-70 Empty.
       
       Bottom Half (Wrapper 200px):
       Sees 200-400 of the 400px universe.
       Content: 200-330 is Text. 330-400 Empty.
       
       So the cut is at 200px.
       Text is 70-330. Center is 200.
       Text center is strictly at cut.
       This is theoretically perfect for split.
       
       Issue: Maybe slight 1px subpixel rendering gap?
       
       Fix:
       Add `backface-visibility: hidden` explicitly to the span as well? No.
       
       Actually, `transform: rotateX(180deg)` might be causing a Z-index issue where it flickers?
       
       Let's try to remove `display: flex` on the spans and use absolute positioning with line-height matching full height.
       This is more robust for split-flaps.
       
       New span logic:
       `display: block; height: 400px; line-height: 400px; text-align: center; width: 100%;`
       
       If I change this, I avoid `transform: translateY` entirely (which I already removed for `flipBack`, but logic relied on flex).
       
       Let's Rewrite the Text Positioning Logic block to be dead simple and robust.
    */
}

/* Text Positioning Logic */
.upper .digit,
.flipFront .digit,
.lower .digit,
.flipBack .digit {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 200%;
    line-height: 1;
}

.upper .digit,
.flipFront .digit {
    position: absolute;
    top: 0;
    left: 0;
}

.lower .digit,
.flipBack .digit {
    position: absolute;
    top: -100%;
    left: 0;
}

@keyframes flipDown {
    0% {
        transform: rotateX(0deg);
    }

    100% {
        transform: rotateX(-180deg);
    }
}